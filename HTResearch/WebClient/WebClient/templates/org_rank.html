{% extends "global.html" %}

{% block imports %}
    <title>All Organizations</title>
    <script src="/static/scripts/org-datasource.js" type="text/javascript"></script>
    <link href="http://www.fuelcdn.com/fuelux-imh/2.4.0/css/fuelux.css" rel="stylesheet"/>
{% endblock %}
{% block bootstrap %}
    <script src="http://www.fuelcdn.com/fuelux-imh/2.4.0/loader.min.js" type="text/javascript"></script>
{% endblock %}


{% block content %}
    <script>
        $(function () {
            $('#org-rank-table').datagrid({
                dataSource: new OrgDataSource({
                    // Column definitions for Datagrid
                    columns: [
                        {
                            property: 'num',
                            label: '#',
                            sortable: false
                        },
                        {
                            property: 'name',
                            label: 'Name',
                            sortable: true
                        },
                        {
                            property: 'address',
                            label: 'Address',
                            sortable: false
                        },
                        {
                            property: 'phone_numbers',
                            label: 'Phone Numbers',
                            sortable: false
                        },
                        {
                            property: 'emails',
                            label: 'E-Mails',
                            sortable: false
                        },
                        {
                            property: 'organization_url',
                            label: 'Website',
                            sortable: false
                        },
                        {
                            property: 'facebook',
                            label: 'Facebook',
                            sortable: false
                        },
                        {
                            property: 'twitter',
                            label: 'Twitter',
                            sortable: false
                        }
                    ],
                    formatter: function (items, startIndex) {
                        $.each(items, function (index, item) {
                            item.num = (startIndex + index) + '<span style="display: none;" class="org-data-row-id">' + item.id + '</span>';
                            if (item.organization_url)
                                item.organization_url = '<a target="_blank" href="' + item.organization_url + '">Site</a>';
                            else
                                item.organization_url = '';
                            if (item.phone_numbers)
                                item.phone_numbers = item.phone_numbers.join(', ');
                            else
                                item.phone_numbers = '';
                            if (item.emails)
                                item.emails = item.emails.join(', ');
                            else
                                item.emails = '';
                            if (item.facebook)
                                item.facebook = '<a target="_blank" href="' + item.facebook + '">FB</a>';
                            else
                                item.facebook = '';
                            if (item.twitter)
                                item.twitter = '<a target="_blank" href="' + item.twitter + '">TW</a>';
                            else
                                item.twitter = '';
                        });
                    }
                }),
                stretchHeight: true
            });

            $('#org-rank-table').on('dblclick', 'tbody > tr', function () {
                var id = $(this).find('.org-data-row-id').html();
                if (id)
                    window.location.href = '/organization/' + id;
            })
        });
    </script>
    <div class="fuelux" style="padding: 10px;">
    <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12" style="overflow-x: scroll">
            <table id="org-rank-table" class="table table-hover table-bordered datagrid">
                <thead>
                <tr>
                    <th>
                        <span class="datagrid-header-title">View All Organizations</span>

                        <div class="datagrid-header-left">
                            <div class="input-append search datagrid-search">
                                <input type="text" class="input-medium" placeholder="Search">
                                <button type="button" class="btn"><i class="icon-search"></i></button>
                            </div>
                        </div>
                        <div class="datagrid-header-right">
                        </div>
                    </th>
                </tr>
                </thead>
                <tfoot>
                <tr>
                    <th>
                        <div class="datagrid-footer-left">
                            <div class="grid-controls">
                            <span>
                                <span class="grid-start"></span> -
                                <span class="grid-end"></span> of
                                <span class="grid-count"></span>
                            </span>

                                <div class="select grid-pagesize" data-resize="auto">
                                    <button type="button" data-toggle="dropdown" class="btn dropdown-toggle">
                                        <span class="dropdown-label"></span>
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu">
                                        <li data-value="5"><a href="#">5</a></li>
                                        <li data-value="10" data-selected="true"><a href="#">10</a></li>
                                        <li data-value="20"><a href="#">20</a></li>
                                        <li data-value="50"><a href="#">50</a></li>
                                        <li data-value="100"><a href="#">100</a></li>
                                    </ul>
                                </div>
                                <span>Per Page</span>
                            </div>
                        </div>
                        <div class="datagrid-footer-right">
                            <div class="grid-pager">
                                <button type="button" class="btn grid-prevpage"><i
                                        class="icon-chevron-left"></i>
                                </button>
                                <span>Page</span>

                                <div class="input-append dropdown combobox">
                                    <input class="span1" type="text">
                                    <button type="button" class="btn" data-toggle="dropdown">
                                        <i class="caret"></i>
                                    </button>
                                    <ul class="dropdown-menu"></ul>
                                </div>


                                <span>of <span class="grid-pages"></span></span>
                                <button type="button" class="btn grid-nextpage"><i
                                        class="icon-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </th>
                </tr>
                </tfoot>

            </table>
        </div>
    </div>
{% endblock %}
